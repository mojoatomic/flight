{
  "domain": "clerk",
  "version": "1.1.0",
  "file_patterns": [
    "**/*.ts",
    "**/*.tsx"
  ],
  "exclude_patterns": [
    "**/node_modules/**",
    "**/dist/**",
    "**/build/**",
    "**/.git/**",
    "**/*.d.ts"
  ],
  "provenance": {
    "last_full_audit": "2026-01-16",
    "audited_by": "flight-research",
    "next_audit_due": "2026-07-16"
  },
  "rules": [
    {
      "id": "N1",
      "title": "Secret Key in Client Code",
      "severity": "NEVER",
      "type": "grep",
      "pattern": "CLERK_SECRET_KEY|secretKey.*clerk",
      "query": null,
      "message": "CLERK_SECRET_KEY must never appear in client-accessible code. It has admin privileges. Only use in server-side code that is never bundled to client.",
      "provenance": {
        "last_verified": "2026-01-16",
        "confidence": "high",
        "re_verify_after": "2027-01-16"
      }
    },
    {
      "id": "N2",
      "title": "Deprecated authMiddleware",
      "severity": "NEVER",
      "type": "grep",
      "pattern": "authMiddleware|from ['\"]@clerk/nextjs['\"].*authMiddleware",
      "query": null,
      "message": "authMiddleware is deprecated. Use clerkMiddleware() instead. authMiddleware has known issues with Next.js 14+ and doesn't support the new routing patterns.",
      "provenance": {
        "last_verified": "2026-01-16",
        "confidence": "high",
        "re_verify_after": "2027-01-16"
      }
    },
    {
      "id": "N4",
      "title": "Synchronous auth() Call in Next.js 15+",
      "severity": "NEVER",
      "type": "grep",
      "pattern": "const\\s*\\{[^}]*\\}\\s*=\\s*auth\\(\\)",
      "query": null,
      "message": "In Next.js 15+, auth() returns a Promise. Must be awaited. Synchronous usage causes runtime errors.",
      "provenance": {
        "last_verified": "2026-01-16",
        "confidence": "high",
        "re_verify_after": "2027-01-16"
      }
    },
    {
      "id": "N5",
      "title": "Hardcoded Clerk Keys",
      "severity": "NEVER",
      "type": "grep",
      "pattern": "pk_test_[a-zA-Z0-9]+|pk_live_[a-zA-Z0-9]+|sk_test_[a-zA-Z0-9]+|sk_live_[a-zA-Z0-9]+",
      "query": null,
      "message": "Never hardcode Clerk publishable or secret keys. Use environment variables. Hardcoded credentials get committed and leaked.",
      "provenance": {
        "last_verified": "2026-01-16",
        "confidence": "high",
        "re_verify_after": "2027-01-16"
      }
    }
  ]
}