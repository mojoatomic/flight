{
  "domain": "embedded-c-p10",
  "version": "1.2.0",
  "language": "c",
  "file_patterns": [
    "**/*.c"
  ],
  "exclude_patterns": [
    "**/node_modules/**",
    "**/dist/**",
    "**/build/**",
    "**/.git/**"
  ],
  "provenance": {
    "last_full_audit": "2026-01-22",
    "audited_by": "flight-research",
    "next_audit_due": "2026-07-22"
  },
  "rules": [
    {
      "id": "N3",
      "title": "No Dynamic Memory Allocation",
      "severity": "NEVER",
      "type": "ast",
      "language": "c",
      "pattern": null,
      "query": "(call_expression\n  function: (identifier) @violation\n  (#match? @violation \"^(malloc|free|calloc|realloc)$\"))",
      "message": "Never use malloc, free, calloc, or realloc. Dynamic memory allocation introduces unpredictable behavior, fragmentation, and potential for memory leaks. Use static allocation with fixed-size buffers.",
      "provenance": {
        "last_verified": "2026-01-22",
        "confidence": "high",
        "re_verify_after": "2027-01-22"
      }
    },
    {
      "id": "N5",
      "title": "No Double Pointer Dereference",
      "severity": "NEVER",
      "type": "ast",
      "language": "c",
      "pattern": null,
      "query": "(pointer_expression\n  argument: (pointer_expression) @violation)",
      "message": "Never use double pointer dereference (**ptr). It indicates overly complex data structures. Flatten data structures or use single indirection with explicit indexing.",
      "provenance": {
        "last_verified": "2026-01-22",
        "confidence": "high",
        "re_verify_after": "2027-01-22"
      }
    },
    {
      "id": "N11",
      "title": "Check or Cast All Return Values",
      "severity": "NEVER",
      "type": "ast",
      "language": "c",
      "pattern": null,
      "query": "(expression_statement\n  (call_expression\n    function: (identifier) @fn\n    (#match? @fn \"^(printf|fprintf|sprintf|snprintf)$\"))) @violation",
      "message": "All function return values must be checked or explicitly cast to (void) if intentionally ignored. This applies especially to printf and fprintf.",
      "provenance": {
        "last_verified": "2026-01-22",
        "confidence": "high",
        "re_verify_after": "2027-01-22"
      }
    }
  ]
}
